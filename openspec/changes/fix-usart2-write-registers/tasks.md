# Tasks: 修复USART2写入寄存器缺失

## Phase 1: 紧急修复 - 禁用USART2新协议层 ⬜

### 1.1 修改main.c
- [ ] 1.1.1 为USART2单独添加条件编译控制
- [ ] 1.1.2 USART2使用旧代码 `Union_ModBus2_Communication()`
- [ ] 1.1.3 其他串口继续使用新协议层

### 1.2 验证测试
- [ ] 1.2.1 编译0错误
- [ ] 1.2.2 烧录测试，验证屏幕通信恢复正常
- [ ] 1.2.3 验证USART1/USART3/UART4新协议层正常

---

## 快速修改

**文件**: `USER/main.c`

修改USART2调度部分，移除新协议层调用：

```c
// 原代码:
#if USE_UNIFIED_MODBUS
    modbusUsart2Scheduler();
#else
    Union_ModBus2_Communication();
#endif

// 修改为 (USART2始终用旧代码):
    Union_ModBus2_Communication();
```

---

## Phase 2: 完整迁移 (后续版本) ⬜

### 2.1 分析缺失地址
- [ ] 2.1.1 整理完整的写入地址表 (约100+个)
- [ ] 2.1.2 分类: 系统控制/机组1-10控制

### 2.2 补全实现
- [ ] 2.2.1 添加系统控制地址 (30-41)
- [ ] 2.2.2 添加机组1控制 (101-116)
- [ ] 2.2.3 添加机组2控制 (121-136)
- [ ] 2.2.4 添加机组3-10控制
- [ ] 2.2.5 测试所有写入功能

### 缺失地址清单

| 地址 | 用途 |
|------|------|
| 30 | 故障复位 |
| 31 | 报警关闭 |
| 32 | 设备类型 |
| 33 | 额定设备数量 |
| 35 | ModBus地址 |
| 36 | 禁止设备数量 |
| 38 | 排烟温度报警值 |
| 40 | 报警允许标志 |
| 41 | 总控继电器输出 |
| 101 | A1功率设定 |
| 108 | A1排污阀 |
| 113 | A1继电器 |
| 114 | A1点火功率 |
| 115 | A1最大功率 |
| 116 | A1温度保护值 |
| 121-136 | A2控制 |
| 141-156 | A3控制 |
| 161-176 | A4控制 |
| 181-196 | A5控制 |
| 201-216 | A6控制 |
| 221-236 | A7控制 |
| 241-256 | A8控制 |
| 261-276 | A9控制 |
| 281-296 | A10控制 |

