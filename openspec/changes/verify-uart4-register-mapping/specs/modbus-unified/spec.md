## ADDED Requirements

### Requirement: UART4从机寄存器映射

UART4从机模式SHALL使用以下寄存器映射与联控主机通信：

**读取寄存器 (地址100, 18寄存器)**:
- 寄存器1: 工作状态 (sys_data.Data_10H)
- 寄存器2: 压力值 (16位)
- 寄存器3: 温度 (预留)
- 寄存器4: 水位状态
- 寄存器5: 异常状态
- 寄存器6: 内部保护温度 (16位)
- 寄存器7: 故障代码
- 寄存器8: 火焰状态
- 寄存器9: 风机转速 (16位)
- 寄存器10: 内部压力 (16位)
- 寄存器11: 工作功率
- 寄存器12: 风机状态
- 寄存器13: 水阀状态
- 寄存器14: 排污阀状态
- 寄存器15: 连续排污状态
- 寄存器16: 预留
- 寄存器17: 高字节=点火标志, 低字节=排污标志
- 寄存器18: 输入状态 (16位)

**写入寄存器 (地址200, 18寄存器)**:
- 寄存器1: 启停控制 (0=停止, 1=启动, 3=手动)
- 寄存器2: 故障复位
- 寄存器3: 设备类型
- 寄存器4: 功率设定 (根据工作状态处理)
- 寄存器5: 继电器控制 (手动模式下位操作)
- 寄存器6: 空闲运行标志
- 寄存器7: 排污标志
- 寄存器8-15: 参数设置

#### Scenario: 从机读取寄存器17格式
- **WHEN** 联控主机读取寄存器17
- **THEN** 高字节返回 sys_flag.TimeDianHuo_Flag
- **AND** 低字节返回 sys_flag.Paiwu_Flag

#### Scenario: 从机读取寄存器18格式
- **WHEN** 联控主机读取寄存器18
- **THEN** 返回完整16位 sys_flag.Inputs_State

#### Scenario: 从机写入功率设定处理
- **WHEN** 联控主机写入寄存器4功率值
- **AND** 系统处于手动模式 (Data_10H==3)
- **THEN** 直接调用 PWM_Adjust 设置功率

#### Scenario: 从机写入功率设定工作模式
- **WHEN** 联控主机写入寄存器4功率值
- **AND** 系统处于工作模式 (Data_10H==2)
- **AND** 火焰状态正常
- **THEN** 设置 sys_flag.AirPower_Need

#### Scenario: 从机写入继电器控制
- **WHEN** 联控主机写入寄存器5继电器控制字
- **AND** 系统处于手动模式 (Data_10H==3)
- **THEN** Bit0控制风机开关
- **AND** Bit1控制水泵/水阀
- **AND** Bit2控制排水阀
- **AND** Bit3控制燃气阀

