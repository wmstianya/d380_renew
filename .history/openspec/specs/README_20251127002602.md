# System Control Specifications Index

`system_control.c` 功能规格说明总索引

## 📋 概述

本目录包含 STM32F103 工业燃气锅炉/蒸汽发生器控制系统的完整功能规格说明。
`system_control.c` 是系统的核心控制文件，包含约5000行代码，实现以下功能模块。

## 📁 规格说明目录

### 🔄 核心控制

| 规格 | 文件 | 说明 |
|------|------|------|
| [系统状态机](system-state-machine/spec.md) | `system-state-machine/spec.md` | 5种系统状态及状态转换逻辑 |
| [点火控制](ignition-control/spec.md) | `ignition-control/spec.md` | 前吹扫、点火、火焰检测、后吹扫完整流程 |
| [压力控制](pressure-control/spec.md) | `pressure-control/spec.md` | PID压力调节、自动启停控制 |

### 🛡️ 安全系统

| 规格 | 文件 | 说明 |
|------|------|------|
| [安全保护](safety-protection/spec.md) | `safety-protection/spec.md` | 23种故障检测和保护机制 |
| [水位控制](water-control/spec.md) | `water-control/spec.md` | 4级水位监测、自动补水控制 |

### 🔧 执行器控制

| 规格 | 文件 | 说明 |
|------|------|------|
| [风机控制](fan-control/spec.md) | `fan-control/spec.md` | 变频风机功率调节、吹扫控制 |

### 🔗 通信与协调

| 规格 | 文件 | 说明 |
|------|------|------|
| [多机联控](multi-device-coordination/spec.md) | `multi-device-coordination/spec.md` | 主从机通信、负荷分配、协同控制 |
| [通信协议](communication-protocol/spec.md) | `communication-protocol/spec.md` | UART、ModBus、主从通信协议 |

### 📊 数据采集与显示

| 规格 | 文件 | 说明 |
|------|------|------|
| [ADS1220驱动](ads1220-driver/spec.md) | `ads1220-driver/spec.md` | 24位ADC驱动、DWT延迟、软件SPI |
| [传感器采集](sensor-acquisition/spec.md) | `sensor-acquisition/spec.md` | ADC采集、信号处理、数据滤波 |
| [显示控制](display-control/spec.md) | `display-control/spec.md` | 串口屏通信、界面更新、触摸响应 |

### ⏱️ 系统任务

| 规格 | 文件 | 说明 |
|------|------|------|
| [定时任务](timer-tasks/spec.md) | `timer-tasks/spec.md` | 定时器配置、周期任务调度 |

---

## 🏗️ 系统架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                         应用层 (Application)                      │
├─────────────────────────────────────────────────────────────────┤
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐           │
│  │ 状态机   │ │ 点火控制 │ │ 压力控制 │ │ 安全保护 │           │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘           │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐           │
│  │ 水位控制 │ │ 风机控制 │ │ 多机联控 │ │ 显示控制 │           │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘           │
├─────────────────────────────────────────────────────────────────┤
│                         驱动层 (Drivers)                         │
├─────────────────────────────────────────────────────────────────┤
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐           │
│  │ UART×5   │ │ ADC/SPI  │ │ GPIO     │ │ Timer    │           │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘           │
├─────────────────────────────────────────────────────────────────┤
│                         硬件层 (Hardware)                        │
├─────────────────────────────────────────────────────────────────┤
│  STM32F103VC │ ADS1220 │ 变频器 │ 串口屏 │ 传感器 │ 执行器      │
└─────────────────────────────────────────────────────────────────┘
```

---

## 📊 故障代码速查表

| 代码 | 名称 | 描述 | 检测位置 |
|------|------|------|----------|
| 1 | Error1_Power | 漏电检测 | 全局 |
| 2 | Error2_OutOverWater | 超高水位 | 补水控制 |
| 3 | Error3_LowGas | 燃气压力低 | 待机/点火/运行 |
| 4 | Error4_FireLose | 意外熄火 | 运行状态 |
| 5 | Error5_LowWater | 极低水位 | 全局 |
| 6 | Error6_OverPress | 超压报警 | 全局 |
| 7 | Error7_BadFire | 点火失败 | 点火流程 |
| 8 | Error8_Sensor | 传感器故障 | 采集模块 |
| 10 | Error10_FireOn | 火焰常有 | 待机/前吹扫 |
| 11 | Error11_WindLose | 风压故障 | 运行状态 |
| 13 | Error13_HighTemp | 超温报警 | 全局 |
| 14 | Error14_NTC | NTC故障 | 温度采集 |
| 18 | Error18_ValveFault | 阀门故障 | 阀门控制 |
| 22 | Error22_Pump | 水泵故障 | 补水控制 |

---

## 📌 关键参数配置

### 点火参数
| 参数 | 默认值 | 范围 | 说明 |
|------|--------|------|------|
| First_Blow_Time | 25秒 | 10-200秒 | 前吹扫时间 |
| Last_Blow_Time | 40秒 | 5-200秒 | 后吹扫时间 |
| Dian_Huo_Power | 30% | 15-60% | 点火功率 |

### 压力参数
| 参数 | 默认值 | 范围 | 说明 |
|------|--------|------|------|
| 目标压力 | 0.5MPa | 0.1-1.0MPa | 运行压力 |
| 停炉压力 | 0.6MPa | - | 自动停炉 |
| 启炉压力 | 0.4MPa | - | 自动启炉 |

---

## 🔗 文件关联

### 源文件
- `SYSTEM/system_control/system_control.c` - 主控制逻辑（~5000行）
- `SYSTEM/system_control/system_control.h` - 头文件定义

### 依赖模块
- `HARDWARE/Parallel_Serial/` - 并行输入输出
- `HARDWARE/usart/` - 串口通信
- `HARDWARE/ADS1220/` - ADC采集
- `HARDWARE/led/` - GPIO控制
- `HARDWARE/timers/` - 定时器

---

## 📝 版本信息

- **创建日期**: 2025-11-26
- **最后更新**: 2025-11-26
- **版本**: 1.0
- **状态**: Active

---

## 📖 如何使用这些规格

1. **理解系统**: 从 [系统状态机](system-state-machine/spec.md) 开始，了解整体运行流程
2. **深入功能**: 查看具体功能模块的规格说明
3. **故障排查**: 参考 [安全保护](safety-protection/spec.md) 了解故障触发条件
4. **修改代码**: 先查阅相关规格，理解现有逻辑后再修改
5. **添加功能**: 在 `openspec/changes/` 创建变更提案

